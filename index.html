<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebar & Hilti RE500V3 Design Report</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #525659; margin: 0; padding: 20px; }
        .a4-page { width: 210mm; min-height: 297mm; padding: 20mm; margin: 20px auto; background: white; box-shadow: 0 0 10px rgba(0,0,0,0.5); box-sizing: border-box; page-break-after: always; }
        .no-print-area { max-width: 210mm; margin: 0 auto 20px auto; background: #fff; padding: 20px; border-radius: 8px; display: flex; gap: 15px; flex-wrap: wrap; }
        .input-item { flex: 1; min-width: 140px; }
        label { display: block; font-size: 13px; font-weight: bold; margin-bottom: 5px; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        .report-header { text-align: center; border-bottom: 3px double #333; margin-bottom: 25px; padding-bottom: 15px; }
        .report-header h1 { margin: 0; color: #c62828; font-size: 24px; }
        h3 { border-left: 6px solid #1a237e; padding-left: 12px; margin-top: 25px; font-size: 18px; color: #1a237e; border-bottom: 1px solid #eee; }
        .formula-line { font-family: 'Courier New', monospace; font-weight: bold; color: #0d47a1; font-size: 15px; margin: 5px 0; }
        .sub-line { font-family: 'Courier New', monospace; color: #444; font-size: 14px; margin-bottom: 10px; padding-left: 20px; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { border: 1px solid #444; padding: 10px; text-align: center; font-size: 14px; }
        .step-box { border: 1px solid #ddd; padding: 15px; border-radius: 5px; background: #fafafa; }
        .highlight-row { background-color: #e3f2fd !important; font-weight: bold; }
        .print-btn { background: #2e7d32; color: white; border: none; padding: 12px 25px; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; font-size: 16px; }
        @media print { body { background: none; padding: 0; } .no-print-area { display: none; } .a4-page { width: 100%; box-shadow: none; padding: 15mm; margin:0; } }
    </style>
</head>
<body>

<div class="no-print-area">
    <div class="input-item"><label>Mu (ton-m/m)</label><input type="number" id="mu" value="8" oninput="runAll()"></div>
    <div class="input-item"><label>Nu (ton/m)</label><input type="number" id="nu" value="0" oninput="runAll()"></div>
    <div class="input-item"><label>d (cm)</label><input type="number" id="d" value="26" oninput="runAll()"></div>
    <div class="input-item"><label>Spacing @ (m)</label><input type="number" id="spacing" value="0.25" step="0.01" oninput="runAll()"></div>
    <div class="input-item">
        <label>‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÄ‡∏™‡∏£‡∏¥‡∏° (Rebar)</label>
        <select id="rebarSize" onchange="runAll()">
            <option value="12">DB12</option>
            <option value="16">DB16</option>
            <option value="20" selected>DB20</option>
            <option value="25">DB25</option>
        </select>
    </div>
    <button class="print-btn" onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (PDF)</button>
</div>

<div class="a4-page">
    <div class="report-header"><h1>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏´‡∏•‡πá‡∏Å</h1></div>
    <h3>1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ (Input Data)</h3>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; padding:15px; background:#f9f9f9; border: 1px solid #ddd;">
        <div>‡πÇ‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå (Mu): <b><span id="p1_mu"></span> t-m/m</b></div>
        <div>‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡πÅ‡∏ô‡∏ß‡πÅ‡∏Å‡∏ô (Nu): <b><span id="p1_nu"></span> t/m</b></div>
        <div>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ú‡∏• (d): <b><span id="p1_d"></span> cm</b></div>
        <div>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏´‡∏•‡πá‡∏Å: <b>DB<span id="p1_size"></span> @ <span id="p1_spacing"></span> m</b></div>
    </div>
    <h3>2. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á (Calculation)</h3>
    <div class="calc-step">
        <div class="formula-line">1) z = 0.9 x d = 0.9 x <span id="p1_c_d"></span> = <b><span id="p1_c_z"></span> cm</b></div>
        <div class="formula-line">2) Tm = (Mu x 10^5) / (0.9 x z) = <span id="p1_c_tm"></span> kg/m</div>
        <div class="formula-line">3) T bar = (Tm + Nu) / (1 / spacing) = <b style="color:red;"><span id="p1_c_tbar"></span> kg/‡πÄ‡∏™‡πâ‡∏ô</b></div>
    </div>
    <h3>3. ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Rebar</h3>
    <table>
        <thead><tr><th>‡∏Ç‡∏ô‡∏≤‡∏î</th><th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (cm2)</th><th>Capacity (kg)</th><th>‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡∏à‡∏£‡∏¥‡∏á</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th></tr></thead>
        <tbody id="rebarBody"></tbody>
    </table>
</div>

<div class="a4-page">
    <div class="report-header"><h1>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏ù‡∏±‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</h1></div>
    <h3>4. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ù‡∏±‡∏á (Embedment Depth Analysis)</h3>
    <div class="calc-step">
        <p>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö <b>Hilti HIT-RE 500 V3</b> ‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï‡∏£‡πâ‡∏≤‡∏ß</p>
        <div class="formula-line">4.1 ‡∏ï‡∏≤‡∏°‡πÅ‡∏£‡∏á‡∏¢‡∏∂‡∏î‡πÄ‡∏Å‡∏≤‡∏∞ (Bond Strength):</div>
        <div class="sub-line">
            f_bd = 100 kg/cm¬≤ | ‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á (d_b) = <span id="p2_dia_text"></span> cm<br>
            h_ef = T_bar / (pi x d_b x f_bd) = <span id="p2_tbar_val"></span> / (3.14 x <span id="p2_dia_val"></span> x 100)<br>
            ‡∏£‡∏∞‡∏¢‡∏∞‡∏ù‡∏±‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì: <b><span id="p2_hef_calc"></span> cm</b>
        </div>
        <div class="formula-line">4.2 ‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ (Min. 12d_b):</div>
        <div class="sub-line">h_min = 12 x <span id="p2_dia_val2"></span> = <b><span id="p2_min_hef"></span> cm</b></div>
    </div>
    <h3>5. ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô (Step-by-Step)</h3>
    <div class="step-box">
        <p>1. <b>‡πÄ‡∏à‡∏≤‡∏∞‡∏£‡∏π:</b> ‡πÉ‡∏ä‡πâ‡∏î‡∏≠‡∏Å‡∏™‡∏ß‡πà‡∏≤‡∏ô <b><span id="p2_bit"></span> mm</b> ‡∏•‡∏∂‡∏Å <b><span id="p2_final_h"></span> cm</b></p>
        <p>2. <b>‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î:</b> ‡πÄ‡∏õ‡πà‡∏≤ 2 / ‡∏Ç‡∏±‡∏î 2 / ‡πÄ‡∏õ‡πà‡∏≤ 2 (‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô Hilti)</p>
        <p>3. <b>‡∏â‡∏µ‡∏î‡∏ô‡πâ‡∏≥‡∏¢‡∏≤:</b> ‡∏â‡∏µ‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡πâ‡∏ô‡∏£‡∏π‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ 2/3 ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å</p>
        <p>4. <b>‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á:</b> ‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏à‡∏ô‡∏™‡∏∏‡∏î‡∏£‡∏π ‡πÅ‡∏•‡∏∞‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÅ‡∏´‡πâ‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤ Curing</p>
    </div>
    <div style="margin-top:20px; text-align:center; padding:20px; border:3px solid #d32f2f; background:#fff9c4; font-size:24px;">
        <b>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏ù‡∏±‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: <span id="p2_final_h2"></span> cm</b>
    </div>
</div>

<script>
function runAll() {
    const mu = parseFloat(document.getElementById('mu').value) || 0;
    const nu = parseFloat(document.getElementById('nu').value) || 0;
    const d = parseFloat(document.getElementById('d').value) || 0;
    const spacing = parseFloat(document.getElementById('spacing').value) || 0;
    const selectedSize = parseInt(document.getElementById('rebarSize').value);

    // Calc Page 1
    const z = 0.9 * d;
    const tm = (z > 0) ? (mu * 100000) / (0.9 * z) : 0;
    const t_total = tm + (nu * 1000);
    const qty_bar = spacing > 0 ? 1/spacing : 0;
    const t_bar = qty_bar > 0 ? t_total / qty_bar : 0;

    // Update Page 1 UI
    document.getElementById('p1_mu').innerText = mu;
    document.getElementById('p1_nu').innerText = nu;
    document.getElementById('p1_d').innerText = d;
    document.getElementById('p1_size').innerText = selectedSize;
    document.getElementById('p1_spacing').innerText = spacing;
    document.getElementById('p1_c_d').innerText = d;
    document.getElementById('p1_c_z').innerText = z.toFixed(2);
    document.getElementById('p1_c_tm').innerText = Math.round(tm).toLocaleString();
    document.getElementById('p1_c_tbar').innerText = Math.round(t_bar).toLocaleString();

    // Rebar Table
    const rebars = [
        {name: 'DB12', area: 1.13, cap: 4520, d: 1.2},
        {name: 'DB16', area: 2.01, cap: 8040, d: 1.6},
        {name: 'DB20', area: 3.14, cap: 12560, d: 2.0},
        {name: 'DB25', area: 4.91, cap: 19640, d: 2.5}
    ];
    let rows = "";
    rebars.forEach(r => {
        let isPass = t_bar <= r.cap;
        let isSel = selectedSize == (r.d * 10);
        rows += `<tr class="${isSel ? 'highlight-row' : ''}">
            <td>${r.name}</td><td>${r.area}</td><td>${r.cap.toLocaleString()}</td>
            <td>${Math.round(t_bar).toLocaleString()}</td>
            <td style="color:${isPass?'green':'red'}">${isPass?'PASS':'OVER'}</td></tr>`;
    });
    document.getElementById('rebarBody').innerHTML = rows;

    // Calc Page 2 (Dynamic by Selected Size)
    const dia_cm = selectedSize / 10;
    const hef_calc = t_bar / (Math.PI * dia_cm * 100);
    const hef_min = selectedSize * 1.2;
    const final_h = Math.max(hef_calc * 1.3, hef_min, 15); // Factor 1.3 for safety

    document.getElementById('p2_dia_text').innerText = dia_cm.toFixed(1);
    document.getElementById('p2_tbar_val').innerText = Math.round(t_bar).toLocaleString();
    document.getElementById('p2_dia_val').innerText = dia_cm.toFixed(1);
    document.getElementById('p2_hef_calc').innerText = hef_calc.toFixed(2);
    document.getElementById('p2_dia_val2').innerText = dia_cm.toFixed(1);
    document.getElementById('p2_min_hef').innerText = hef_min.toFixed(1);
    
    document.getElementById('p2_bit').innerText = selectedSize + 4; // ‡∏î‡∏≠‡∏Å‡∏™‡∏ß‡πà‡∏≤‡∏ô = ‡πÄ‡∏´‡∏•‡πá‡∏Å + 4mm
    document.getElementById('p2_final_h').innerText = Math.ceil(final_h);
    document.getElementById('p2_final_h2').innerText = Math.ceil(final_h);
}
runAll();
</script>
</body>
</html>
