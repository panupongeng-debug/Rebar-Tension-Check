<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebar Tension Report - Clean Version</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; background-color: #525659; margin: 0; padding: 20px; }
        
        .a4-page {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            box-sizing: border-box;
        }

        .no-print-area {
            max-width: 210mm;
            margin: 0 auto 20px auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .input-item { flex: 1; min-width: 140px; }
        label { display: block; font-size: 13px; font-weight: bold; margin-bottom: 5px; color: #333; }
        input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }

        .report-header { text-align: center; border-bottom: 3px double #333; margin-bottom: 30px; padding-bottom: 15px; }
        .report-header h1 { margin: 0; color: #c62828; font-size: 26px; }
        
        h3 { border-left: 6px solid #1a237e; padding-left: 12px; margin-top: 30px; font-size: 19px; color: #1a237e; }

        .data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; background: #fcfcfc; padding: 20px; border-radius: 5px; border: 1px solid #eee; }
        
        .calc-step { margin-top: 25px; padding-left: 10px; }
        .formula-box { 
            font-family: 'Courier New', Courier, monospace; 
            background: #f1f3f4; 
            padding: 15px; 
            display: block; 
            margin: 10px 0; 
            font-weight: bold; 
            color: #0d47a1;
            border-radius: 4px;
            font-size: 16px;
        }

        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #444; padding: 12px; text-align: center; font-size: 15px; }
        th { background-color: #f5f5f5; font-weight: bold; }

        .print-btn {
            background: #2e7d32; color: white; border: none; padding: 12px 25px;
            border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; font-size: 16px;
        }
        .print-btn:hover { background: #1b5e20; }

        @media print {
            body { background: none; padding: 0; margin: 0; }
            .no-print-area { display: none; }
            .a4-page { width: 100%; height: auto; margin: 0; box-shadow: none; padding: 15mm; }
            @page { size: A4; margin: 0; }
        }
    </style>
</head>
<body>

<div class="no-print-area">
    <div class="input-item"><label>Mu (ton-m/m)</label><input type="number" id="mu" value="8" oninput="calc()"></div>
    <div class="input-item"><label>Nu (ton/m)</label><input type="number" id="nu" value="0" oninput="calc()"></div>
    <div class="input-item"><label>d (cm)</label><input type="number" id="d" value="26" oninput="calc()"></div>
    <div class="input-item"><label>Spacing @ (m)</label><input type="number" id="spacing" value="0.25" step="0.01" oninput="calc()"></div>
    <button class="print-btn" onclick="window.print()">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô PDF (A4)</button>
</div>

<div class="a4-page">
    <div class="report-header">
        <h1>‡πÉ‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡πÉ‡∏ô‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÄ‡∏™‡∏£‡∏¥‡∏°</h1>
        <div style="font-size: 14px; color: #555; margin-top: 5px;">Reinforced Concrete Tension Analysis</div>
    </div>

    <h3>1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö (Design Criteria)</h3>
    <div class="data-grid">
        <div>‚Ä¢ ‡πÇ‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö (Mu): <strong><span id="v_mu">8</span> ton-m/m</strong></div>
        <div>‚Ä¢ ‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡πÅ‡∏ô‡∏ß‡πÅ‡∏Å‡∏ô (Nu): <strong><span id="v_nu">0</span> ton/m</strong></div>
        <div>‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ú‡∏• (d): <strong><span id="v_d">26</span> cm</strong></div>
        <div>‚Ä¢ ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÄ‡∏´‡∏•‡πá‡∏Å: <strong>‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å @ <span id="v_spacing">0.25</span> m</strong></div>
    </div>

    <h3>2. ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Calculation Steps)</h3>
    
    <div class="calc-step">
        <strong>2.1 ‡∏£‡∏∞‡∏¢‡∏∞‡πÅ‡∏Ç‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏£‡∏á (Lever Arm, z):</strong>
        <div class="formula-box">z = 0.9 x d = 0.9 x <span id="c_d1">26</span> = <span id="c_z">23.40</span> cm</div>
    </div>

    <div class="calc-step">
        <strong>2.2 ‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏î‡∏±‡∏î (Tm):</strong>
        <div class="formula-box">Tm = (Mu x 100,000) / (0.9 x z) = (<span id="c_mu1">8</span> x 100,000) / (0.9 x <span id="c_z1">23.40</span>) = <span id="c_tm">37,987</span> kg/m</div>
    </div>

    <div class="calc-step">
        <strong>2.3 ‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (T total):</strong>
        <div class="formula-box">T total = Tm + Nu = <span id="c_tm1">37,987</span> + <span id="c_nu1">0</span> = <span id="c_tt">37,987</span> kg/m</div>
    </div>

    <div class="calc-step">
        <strong>2.4 ‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏´‡∏•‡πá‡∏Å 1 ‡πÄ‡∏™‡πâ‡∏ô (T bar):</strong>
        <div style="margin-bottom: 5px;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏ï‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á 1 ‡πÄ‡∏°‡∏ï‡∏£ = 1 / <span id="c_qty_val">0.25</span> = <span id="c_qty">4.0</span> ‡πÄ‡∏™‡πâ‡∏ô</div>
        <div class="formula-box" style="color: #c62828; font-size: 1.2em; border: 1px solid #c62828;">T bar = <span id="c_tt1">37,987</span> / <span id="c_qty1">4.0</span> = <span id="c_tbar">9,497</span> kg/‡πÄ‡∏™‡πâ‡∏ô</div>
    </div>

    <h3>3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏±‡∏™‡∏î‡∏∏ (Material Verification)</h3>
    <table>
        <thead>
            <tr>
                <th>‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÄ‡∏™‡∏£‡∏¥‡∏°</th>
                <th>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏±‡∏î (cm2)</th>
                <th>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏£‡∏≤‡∏Å (fy = 4,000 ksc)</th>
                <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Status)</th>
            </tr>
        </thead>
        <tbody id="resTable"></tbody>
    </table>

    <div style="margin-top: 50px; font-size: 13px; color: #777; text-align: right; border-top: 1px solid #eee; padding-top: 10px;">
        ‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡∏£‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£: <span id="dateText"></span>
    </div>
</div>

<script>
function calc() {
    let mu = parseFloat(document.getElementById('mu').value) || 0;
    let nu = parseFloat(document.getElementById('nu').value) || 0;
    let d = parseFloat(document.getElementById('d').value) || 0;
    let spacing = parseFloat(document.getElementById('spacing').value) || 0;

    let z = 0.9 * d;
    let tm = (z > 0) ? (mu * 100000) / (0.9 * z) : 0;
    let n_kg = nu * 1000;
    let tt = tm + n_kg;
    let qty = spacing > 0 ? 1 / spacing : 0;
    let tbar = qty > 0 ? tt / qty : 0;

    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
    document.getElementById('v_mu').innerText = mu.toLocaleString();
    document.getElementById('v_nu').innerText = n_kg.toLocaleString();
    document.getElementById('v_d').innerText = d;
    document.getElementById('v_spacing').innerText = spacing;
    
    document.getElementById('c_d1').innerText = d;
    document.getElementById('c_z').innerText = z.toFixed(2);
    document.getElementById('c_mu1').innerText = mu;
    document.getElementById('c_z1').innerText = z.toFixed(2);
    document.getElementById('c_tm').innerText = Math.round(tm).toLocaleString();
    document.getElementById('c_tm1').innerText = Math.round(tm).toLocaleString();
    document.getElementById('c_nu1').innerText = Math.round(n_kg).toLocaleString();
    document.getElementById('c_tt').innerText = Math.round(tt).toLocaleString();
    document.getElementById('c_qty_val').innerText = spacing;
    document.getElementById('c_qty').innerText = qty.toFixed(1);
    document.getElementById('c_qty1').innerText = qty.toFixed(1);
    document.getElementById('c_tt1').innerText = Math.round(tt).toLocaleString();
    document.getElementById('c_tbar').innerText = Math.round(tbar).toLocaleString();

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
    const rebars = [
        {name: 'DB12', area: 1.13, limit: 4520},
        {name: 'DB16', area: 2.01, limit: 8040},
        {name: 'DB20', area: 3.14, limit: 12560},
        {name: 'DB25', area: 4.91, limit: 19640}
    ];
    let rows = "";
    rebars.forEach(r => {
        let isPass = tbar <= r.limit;
        rows += `<tr style="background:${isPass ? 'white' : '#fff5f5'}">
            <td>${r.name}</td>
            <td>${r.area}</td>
            <td>${r.limit.toLocaleString()} kg</td>
            <td style="color:${isPass ? '#2e7d32' : '#c62828'}; font-weight:bold">${isPass ? 'PASS' : 'OVER'}</td>
        </tr>`;
    });
    document.getElementById('resTable').innerHTML = rows;
}

// ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
document.getElementById('dateText').innerText = new Date().toLocaleDateString('th-TH');
// ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
calc();
</script>

</body>
</html>
